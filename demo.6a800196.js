(function () {var j={};function M(r){var e=r.indexOf(" ");return[r.slice(0,e),r.slice(e+1)]}function ta(r,e){if(r&&!e)return!1;if(!r&&e)return!0;if(r.time>e.time)return!1;if(r.time<e.time)return!0;var i=M(r.id),t=M(e.id);return!(i[1]>t[1])&&(i[1]<t[1]||!(i[0]>t[0])&&i[0]<t[0])}j=ta;var N={};function O(e,r){return e.lastAdded+=1,r[1].added=e.lastAdded,e.added.push(r),Promise.resolve(r[1])}function u(e,r){for(var t=e.length-1;t>=0;t--)if(r===e[t][1].id)return t;return-1}function v(e){return void 0!==e}function P(){this.created=[],this.added=[],this.lastReceived=0,this.lastAdded=0,this.lastSent=0}P.prototype={add:function(e,r){for(var t=[e,r],d=r.id,i=this.created,s=0;s<i.length;s++){var a=i[s];if(d===a[1].id)return Promise.resolve(!1);if(!j(a[1],r))return i.splice(s,0,t),O(this,t)}return i.push(t),O(this,t)},byId:function(e){var r=u(this.created,e);if(-1===r)return Promise.resolve([null,null]);var t=this.created[r];return Promise.resolve([t[0],t[1]])},remove:function(e,r){if(void 0===r&&-1===(r=u(this.created,e)))return Promise.resolve(!1);var t=[this.created[r][0],this.created[r][1]];this.created.splice(r,1);for(var d=t[1].added,i=0,s=this.added.length-1;i<=s;){var a=s+i>>1,n=this.added[a][1].added;if(n<d)i=a+1;else{if(!(n>d)){this.added.splice(a,1);break}s=a-1}}return Promise.resolve(t)},get:function(e){var r;return r="created"===e.order?this.created:this.added,Promise.resolve({entries:r.slice(0)})},changeMeta:function(e,r){var t=u(this.created,e);if(-1===t)return Promise.resolve(!1);var d=this.created[t][1];for(var i in r)d[i]=r[i];return Promise.resolve(!0)},removeReason:function(e,r,t){var d,i,s=[];if(r.id){var a=u(this.created,r.id);-1!==a&&(d=this.created[a][1],-1!==(i=d.reasons.indexOf(e))&&(d.reasons.splice(i,1),0===d.reasons.length&&(t(this.created[a][0],d),this.remove(r.id))))}else this.created=this.created.filter(function(a){d=a[1];var n=r;return-1===(i=d.reasons.indexOf(e))||!(!v(n.olderThan)||j(d,n.olderThan))||!(!v(n.youngerThan)||j(n.youngerThan,d))||!!(v(n.minAdded)&&d.added<n.minAdded)||!!(v(n.maxAdded)&&d.added>n.maxAdded)||(d.reasons.splice(i,1),0!==d.reasons.length||(t(a[0],d),s.push(d.added),!1))}),this.added=this.added.filter(function(e){return-1===s.indexOf(e[1].added)});return Promise.resolve()},clean:function(){return this.created=[],this.added=[],this.lastReceived=0,this.lastAdded=0,this.lastSent=0,Promise.resolve()},getLastAdded:function(){return Promise.resolve(this.lastAdded)},getLastSynced:function(){return Promise.resolve({received:this.lastReceived,sent:this.lastSent})},setLastSynced:function(e){return void 0!==e.sent&&(this.lastSent=e.sent),void 0!==e.received&&(this.lastReceived=e.received),Promise.resolve()}},N=P;var k={};(k=function(){this.events={}}).prototype={emit:function(t){var n=[].slice.call(arguments,1);[].slice.call(this.events[t]||[]).filter(function(t){t.apply(null,n)})},on:function(t,n){return(this.events[t]=this.events[t]||[]).push(n),function(){this.events[t]=this.events[t].filter(function(t){return t!==n})}.bind(this)}};var r={};function l(r,o,e){Error.call(this,r),this.name="LoguxError",this.type=r,this.options=o,this.description=l.describe(r,o),this.received=!!e,this.message="",e?(this.message+="Logux received "+this.type+" error",this.description!==this.type&&(this.message+=" ("+this.description+")")):this.message=this.description,Error.captureStackTrace&&Error.captureStackTrace(this,l)}l.describe=function(r,o){return"timeout"===r?"A timeout was reached ("+o+"ms)":"wrong-format"===r?"Wrong message format in "+o:"unknown-message"===r?"Unknown message `"+o+"` type":"bruteforce"===r?"Too many wrong authentication attempts":"wrong-protocol"===r?"Logux supports protocols only from version "+o.supported+", but you use "+o.used:"wrong-subprotocol"===r?"Only "+o.supported+" application subprotocols are supported, but you use "+o.used:"wrong-credentials"===r?"Wrong credentials":r},l.prototype=Error.prototype,r=l;var ua={};function Q(o,t,e,n){if(!o.options.auth)return o.authenticated=!0,void n();o.options.auth(e,t).then(function(t){if(t){o.authenticated=!0,n();for(var e=0;e<o.unauthenticated.length;e++)o.onMessage(o.unauthenticated[e]);o.unauthenticated=[]}else o.sendError(new r("wrong-credentials")),o.destroy()}).catch(function(t){"LoguxError"===t.name?(o.sendError(t),o.destroy()):o.error(t)})}function R(o,t){return o.remoteProtocol=t,t>=o.minProtocol||(o.sendError(new r("wrong-protocol",{supported:o.minProtocol,used:t})),o.destroy(),!1)}function S(o){try{o.emitter.emit("connect")}catch(t){if("LoguxError"===t.name)return o.sendError(t),!1;throw t}return!0}ua={sendConnect:function(){var o=["connect",this.localProtocol,this.localNodeId,this.lastReceived],t={};this.options.credentials&&(t.credentials=this.options.credentials),this.options.subprotocol&&(t.subprotocol=this.options.subprotocol),Object.keys(t).length>0&&o.push(t),this.options.fixTime&&(this.connectSended=this.now()),this.startTimeout(),this.send(o)},sendConnected:function(o,t){var e=["connected",this.localProtocol,this.localNodeId,[o,t]],n={};this.options.credentials&&(n.credentials=this.options.credentials),this.options.subprotocol&&(n.subprotocol=this.options.subprotocol),Object.keys(n).length>0&&e.push(n),this.send(e)},connectMessage:function(o,t,e,n){var r=this.now();if(n||(n={}),this.remoteNodeId=t,R(this,o))if(this.remoteSubprotocol=n.subprotocol||"0.0.0",S(this)){var i=this;Q(this,t,n.credentials,function(){i.baseTime=i.now(),i.sendConnected(r,i.baseTime),i.syncSince(e)})}else this.destroy()},connectedMessage:function(o,t,e,n){if(n||(n={}),this.endTimeout(),this.remoteNodeId=t,R(this,o)){if(this.baseTime=e[1],this.options.fixTime){var r=this.now(),i=e[1]-e[0],s=r-this.connectSended-i;this.timeFix=Math.floor(this.connectSended-e[0]+s/2)}if(this.remoteSubprotocol=n.subprotocol||"0.0.0",S(this)){var c=this;Q(this,t,n.credentials,function(){c.syncSince(c.lastSent)})}else this.destroy()}}};var va={};va={sendError:function(r){var o=["error",r.type];void 0!==r.options&&o.push(r.options),this.send(o),this.emitter.emit("clientError",r)},errorMessage:function(r,o){this.syncError(r,o,!0)}};var wa={};wa={sendDebug:function(e,t){this.send(["debug",e,t])},debugMessage:function(e,t){this.emitter.emit("debug",e,t)}};var xa={};xa={sendPing:function(){this.startTimeout(),this.send(["ping",this.lastAddedCache]),this.pingTimeout&&clearTimeout(this.pingTimeout)},pingMessage:function(t){this.setLastReceived(t),this.connected&&this.authenticated&&this.send(["pong",this.lastAddedCache])},pongMessage:function(t){this.setLastReceived(t),this.endTimeout()}};var h,i,b={};function z(){throw new Error("setTimeout has not been defined")}function A(){throw new Error("clearTimeout has not been defined")}function T(r){if(h===setTimeout)return setTimeout(r,0);if((h===z||!h)&&setTimeout)return h=setTimeout,setTimeout(r,0);try{return h(r,0)}catch($){try{return h.call(null,r,0)}catch($){return h.call(this,r,0)}}}function ya(r){if(i===clearTimeout)return clearTimeout(r);if((i===A||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(r);try{return i(r)}catch($){try{return i.call(null,r)}catch($){return i.call(this,r)}}}!function(){try{h="function"==typeof setTimeout?setTimeout:z}catch(r){h=z}try{i="function"==typeof clearTimeout?clearTimeout:A}catch(r){i=A}}();var m,f=[],B=!1,U=-1;function za(){B&&m&&(B=!1,m.length?f=m.concat(f):U=-1,f.length&&V())}function V(){if(!B){var r=T(za);B=!0;for(var $=f.length;$;){for(m=f,f=[];++U<$;)m&&m[U].run();U=-1,$=f.length}m=null,B=!1,ya(r)}}function W(r,$){this.fun=r,this.array=$}function e(){}b.nextTick=function(r){var $=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)$[e-1]=arguments[e];f.push(new W(r,$)),1!==f.length||B||T(V)},W.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.env={},b.argv=[],b.version="",b.versions={},b.on=e,b.addListener=e,b.once=e,b.off=e,b.removeListener=e,b.removeAllListeners=e,b.emit=e,b.prependListener=e,b.prependOnceListener=e,b.listeners=function(r){return[]},b.binding=function(r){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(r){throw new Error("process.chdir is not supported")},b.umask=function(){return 0};var Aa={};Aa={sendSync:function(i,e){this.startTimeout();for(var t=[],n=0;n<e.length;n++){var s=e[n][1],d={};for(var r in s)"id"===r?d.id=s.id.split(" "):"added"!==r&&(d[r]=s[r]);this.timeFix&&(d.time-=this.timeFix),d.id[0]=parseInt(d.id[0])-this.baseTime,d.id[2]=parseInt(d.id[2]),d.time-=this.baseTime,d.id[1]===this.localNodeId&&(0===d.id[2]?d.id=d.id[0]:d.id=[d.id[0],d.id[2]]),t.unshift(e[n][0],d)}this.syncing+=1,this.setState("sending"),this.send(["sync",i].concat(t))},sendSynced:function(i){this.send(["synced",i])},syncMessage:function(i){for(var e=this,t=[],n=1;n<arguments.length-1;n+=2){var s=arguments[n],d=arguments[n+1];"number"==typeof d.id?d.id=d.id+this.baseTime+" "+this.remoteNodeId+" 0":(d.id[0]=d.id[0]+this.baseTime,2===d.id.length?d.id=d.id[0]+" "+this.remoteNodeId+" "+d.id[1]:d.id=d.id.join(" ")),d.time=d.time+this.baseTime,e.timeFix&&(d.time=d.time+e.timeFix);var r=Promise.resolve([s,d]);e.options.inMap&&(r=r.then(function(i){return e.options.inMap(i[0],i[1])}).catch(function(i){e.error(i)})),r.then(function(i){return e.options.inFilter?e.options.inFilter(i[0],i[1]).then(function(e){return!!e&&i}).catch(function(i){e.error(i)}):i}).then(function(i){return!!i&&(e.received[i[1].id]=!0,e.log.add(i[0],i[1]))}),t.push(r)}Promise.all(t).then(function(){e.setLastReceived(i),e.sendSynced(i)})},syncedMessage:function(i){this.endTimeout(),this.setLastSent(i),this.syncing>0&&(this.syncing-=1),0===this.syncing&&this.setState("synchronized")}};var C={},X=[va,ua,xa,Aa,wa],Ba={"wrong-subprotocol":!0,"wrong-protocol":!0,timeout:!0},Ca=["connect","connected","error","debug"];function Y(e,t,n){var i=n.added;if(void 0===i){var o=e.lastAddedCache;i=o>e.lastSent?o:e.lastSent}e.options.outMap?e.options.outMap(t,n).then(function(t){e.sendSync(i,[t])}).catch(function(t){e.error(t)}):e.sendSync(i,[[t,n]])}function D(e,t,n,i){if(this.localNodeId=e,this.log=t,this.connection=n,this.options=i||{},this.options.ping&&!this.options.timeout)throw new Error("You must set timeout option to use ping");this.connected=!1,this.authenticated=!1,this.unauthenticated=[],this.timeFix=0,this.syncing=0,this.received={},this.lastSent=0,this.lastReceived=0,this.state="disconnected",this.emitter=new k,this.timeouts=[],this.throwsError=!0,this.unbind=[];var o=this;this.unbind.push(t.on("add",function(e,t){o.onAdd(e,t)})),this.unbind.push(n.on("connecting",function(){o.onConnecting()})),this.unbind.push(n.on("connect",function(){o.onConnect()})),this.unbind.push(n.on("message",function(e){o.onMessage(e)})),this.unbind.push(n.on("error",function(e){"Wrong message format"===e.message?(o.sendError(new r("wrong-format",e.received)),o.connection.disconnect("error")):o.error(e)})),this.unbind.push(n.on("disconnect",function(){o.onDisconnect()})),this.initialized=!1,this.lastAddedCache=0,this.initializing=this.initialize()}D.prototype={remoteNodeId:void 0,localProtocol:2,minProtocol:2,remoteProtocol:void 0,remoteSubprotocol:void 0,on:function(e,t){return this.emitter.on(e,t)},catch:function(e){this.throwsError=!1,this.on("error",e)},waitFor:function(e){if(this.state===e)return Promise.resolve();var t=this;return new Promise(function(n){var i=t.on("state",function(){t.state===e&&(i(),n())})})},destroy:function(){this.connection.destroy?this.connection.destroy():this.connected&&this.connection.disconnect("destroy");for(var e=0;e<this.unbind.length;e++)this.unbind[e]();clearTimeout(this.pingTimeout),this.endTimeout()},send:function(e){if(this.connected){this.delayPing();try{this.connection.send(e)}catch(t){this.error(t)}}},onConnecting:function(){this.setState("connecting")},onConnect:function(){this.delayPing(),this.connected=!0},onDisconnect:function(){for(;this.timeouts.length>0;)this.endTimeout();this.pingTimeout&&clearTimeout(this.pingTimeout),this.authenticated=!1,this.connected=!1,this.setState("disconnected")},onMessage:function(e){this.delayPing();var t=e[0];if(this.authenticated||-1!==Ca.indexOf(t)){for(var n=new Array(e.length-1),i=1;i<e.length;i++)n[i-1]=e[i];this[t+"Message"].apply(this,n)}else this.unauthenticated.push(e)},onAdd:function(e,t){if(this.authenticated)if(this.lastAddedCache<t.added&&(this.lastAddedCache=t.added),this.received[t.id])delete this.received[t.id];else if(this.options.outFilter){var n=this;this.options.outFilter(e,t).then(function(i){i&&Y(n,e,t)}).catch(function(e){n.error(e)})}else Y(this,e,t)},syncError:function(e,t,n){var i=new r(e,t,n);if(this.emitter.emit("error",i),!Ba[e]&&this.throwsError)throw i},error:function(e){if(this.emitter.emit("error",e),this.connection.disconnect("error"),this.throwsError)throw e},setState:function(e){this.state!==e&&(this.state=e,this.emitter.emit("state"))},startTimeout:function(){if(this.options.timeout){var e=this.options.timeout,t=this,n=setTimeout(function(){t.connected&&t.connection.disconnect("timeout"),t.syncError("timeout",e)},e);this.timeouts.push(n)}},endTimeout:function(){this.timeouts.length>0&&clearTimeout(this.timeouts.shift())},delayPing:function(){if(this.options.ping){this.pingTimeout&&clearTimeout(this.pingTimeout);var e=this;this.pingTimeout=setTimeout(function(){e.connected&&e.authenticated&&e.sendPing()},this.options.ping)}},syncSinceQuery:function(e){var t=this,n=[];return this.log.each({order:"added"},function(i,o){return!(o.added<=e)&&(t.options.outFilter?n.push(t.options.outFilter(i,o).then(function(e){return!!e&&[i,o]}).catch(function(e){t.error(e)})):n.push(Promise.resolve([i,o])),!0)}).then(function(){return Promise.all(n)}).then(function(e){var t={added:0};return t.entries=e.filter(function(e){return e&&t.added<e[1].added&&(t.added=e[1].added),!1!==e}),t})},syncSince:function(e){var t=this;this.syncSinceQuery(e).then(function(e){t.connected&&(e.entries.length>0?t.options.outMap?Promise.all(e.entries.map(function(e){return t.options.outMap(e[0],e[1])})).then(function(n){t.sendSync(e.added,n)}).catch(function(e){t.error(e)}):t.sendSync(e.added,e.entries):t.setState("synchronized"))})},setLastSent:function(e){this.lastSent<e&&(this.lastSent=e),this.log.store.setLastSynced({sent:e})},setLastReceived:function(e){this.lastReceived<e&&(this.lastReceived=e),this.log.store.setLastSynced({received:e})},now:function(){return Date.now()},initialize:function(){var e=this;return Promise.all([this.log.store.getLastSynced(),this.log.store.getLastAdded()]).then(function(t){e.initialized=!0,e.lastSent=t[0].sent,e.lastReceived=t[0].received,e.lastAddedCache=t[1],e.connection.connected&&e.onConnect()})},sendDuilian:function(){this.send(["duilian",Object.keys(F)[0]])},duilianMessage:function(e){F[e]&&this.send(["duilian",F[e]])}};for(var E=0;E<=X.length;E++){var Z=X[E];for(var $ in Z)D.prototype[$]=Z[$]}var F={"\u91D1\u6728\u6C34\u706B\u571F":"\u677F\u57CE\u70E7\u9505\u9152"};C=D;var s={};s=function(r,o){for(var a in r||(r={}),o)void 0===r[a]&&(r[a]=o[a]);return r};var _={},Da={fixTime:!0,timeout:2e4,ping:5e3};function t(e,t,$,i){i=s(i,Da),C.call(this,e,t,$,i)}t.prototype={onConnect:function(){if(!this.connected){this.connected=!0;var e=this;this.initializing=this.initializing.then(function(){e.connected&&e.sendConnect()})}}},t.prototype=s(t.prototype,C.prototype),_=t;var Ea={};function G(t,e){this.connected=!1,this.emitter=new k,this.type=e,this.pair=t}function aa(t){this.delay=t||1,this.left=new G(this,"left"),this.right=new G(this,"right")}G.prototype={other:function(){return"left"===this.type?this.pair.right:this.pair.left},on:function(t,e){return this.emitter.on(t,e)},connect:function(){if(this.connected)throw new Error("Connection already established");this.emitter.emit("connecting");var t=this;return new Promise(function(e){setTimeout(function(){t.other().connected=!0,t.connected=!0,t.other().emitter.emit("connect"),t.emitter.emit("connect"),e()},t.pair.delay)})},disconnect:function(t){if(this.connected){this.connected=!1,this.emitter.emit("disconnect",t);var e=this;return new Promise(function(t){setTimeout(function(){e.other().connected=!1,e.other().emitter.emit("disconnect"),t()},1)})}throw new Error("Connection already finished")},send:function(t){if(!this.connected)throw new Error("Connection should be started before sending a message");var e=this;setTimeout(function(){e.other().emitter.emit("message",t)},e.pair.delay)}},aa.prototype={},Ea=aa;var ba={};function Fa(e){return(Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ca(e){if(e||(e={}),void 0===e.nodeId)throw new Error("Expected node ID");if("object"!==Fa(e.store))throw new Error("Expected store");if(-1!==e.nodeId.indexOf(" "))throw new Error("Space is prohibited in node ID");this.nodeId=e.nodeId,this.lastTime=0,this.sequence=0,this.store=e.store,this.emitter=new k}ca.prototype={on:function(e,t){return this.emitter.on(e,t)},add:function(e,t){if(void 0===e.type)throw new Error("Expected \"type\" in action");t||(t={});var r=!1;void 0===t.id&&(r=!0,t.id=this.generateId()),void 0===t.time&&(t.time=parseInt(t.id)),void 0===t.reasons?t.reasons=[]:Array.isArray(t.reasons)||(t.reasons=[t.reasons]),t.reasons.forEach(function(e){if("string"!=typeof e)throw new Error("Expected \"reasons\" to be strings")});var n=this;return this.emitter.emit("preadd",e,t),t.keepLast&&(this.removeReason(t.keepLast,{olderThan:t}),t.reasons.push(t.keepLast)),0===t.reasons.length&&r?(this.emitter.emit("add",e,t),this.emitter.emit("clean",e,t),Promise.resolve(t)):0===t.reasons.length?this.store.byId(t.id).then(function(r){return!r[0]&&(n.emitter.emit("add",e,t),n.emitter.emit("clean",e,t),t)}):this.store.add(e,t).then(function(t){return!1!==t&&(n.emitter.emit("add",e,t),t)})},generateId:function(){var e=Date.now();return e<=this.lastTime?(e=this.lastTime,this.sequence+=1):(this.lastTime=e,this.sequence=0),e+" "+this.nodeId+" "+this.sequence},each:function(e,t){t||(t=e,e={order:"created"});var r=this.store;return new Promise(function(n){!function e(r){r().then(function(r){for(var i,o=r.entries.length-1;o>=0;o--){var s=r.entries[o];if(!1===(i=t(s[0],s[1])))break}!1!==i&&r.next?e(r.next):n()})}(r.get.bind(r,e))})},changeMeta:function(e,t){var r;for(r in t)if("id"===r||"added"===r||"time"===r)throw new Error("Meta \""+r+"\" is read-only");var n=this.emitter;return t.reasons&&0===t.reasons.length?this.store.remove(e).then(function(e){if(e){for(r in t)e[1][r]=t[r];n.emit("clean",e[0],e[1])}return!!e}):this.store.changeMeta(e,t)},removeReason:function(e,t){t||(t={});var r=this;return this.store.removeReason(e,t,function(e,t){r.emitter.emit("clean",e,t)})},byId:function(e){return this.store.byId(e)}},ba=ca;var Ga={};function da(t,e,n){if(this.connected=!1,this.emitter=new k,e)this.WS=e;else{if("undefined"==typeof WebSocket)throw new Error("No WebSocket support");this.WS=WebSocket}this.url=t,this.opts=n}da.prototype={init:function(t){var e=this;t.onerror=function(t){e.emitter.emit("error",t.error||new Error("WS Error"))},t.onclose=function(){e.ws&&(e.connected=!1,e.emitter.emit("disconnect"))},t.onmessage=function(t){var n;try{n=JSON.parse(t.data)}catch(r){return void e.error(t.data)}e.emitter.emit("message",n)},this.ws=t},connect:function(){this.emitter.emit("connecting"),this.init(new this.WS(this.url,void 0,this.opts));var t=this;return new Promise(function(e){t.ws.onopen=function(){t.connected=!0,t.emitter.emit("connect"),e()}})},disconnect:function(){this.ws&&(this.ws.onclose(),this.ws.close(),this.ws=void 0)},on:function(t,e){return this.emitter.on(t,e)},send:function(t){this.ws&&this.ws.readyState===this.ws.OPEN?this.ws.send(JSON.stringify(t)):this.emitter.emit("error",new Error("WS was closed"))},error:function(t){var e=new Error("Wrong message format");e.received=t,this.emitter.emit("error",e)}},Ga=da;var Ha={},Ia={minDelay:1e3,maxDelay:5e3,attempts:1/0},Ja=["wrong-protocol","wrong-subprotocol","wrong-credentials"];function H(n,e){this.connection=n,this.options=s(e,Ia),this.reconnecting=n.connected,this.connecting=!1,this.attempts=0,this.unbind=[];var t=this;function i(){!t.reconnecting||t.connected||t.connecting||document.hidden||t.connect()}function o(){!t.reconnecting||t.connected||t.connecting||navigator.onLine&&t.connect()}function c(){t.disconnect("freeze")}this.unbind.push(this.connection.on("message",function(n){"error"===n[0]&&-1!==Ja.indexOf(n[1])&&(t.reconnecting=!1)})),this.unbind.push(this.connection.on("connecting",function(){t.connecting=!0})),this.unbind.push(this.connection.on("connect",function(){t.attempts=0,t.connecting=!1})),this.unbind.push(this.connection.on("disconnect",function(){t.connecting=!1,t.reconnecting&&t.reconnect()})),this.unbind.push(function(){clearTimeout(t.timer)}),"undefined"!=typeof navigator&&(document.addEventListener("visibilitychange",i,!1),window.addEventListener("focus",o,!1),window.addEventListener("online",o,!1),window.addEventListener("resume",o,!1),window.addEventListener("freeze",c,!1),this.unbind.push(function(){document.removeEventListener("visibilitychange",i,!1),window.removeEventListener("focus",o,!1),window.removeEventListener("online",o,!1),window.removeEventListener("resume",o,!1),window.removeEventListener("freeze",c,!1)}))}H.prototype={connect:function(){return this.attempts+=1,this.reconnecting=!0,this.connection.connect()},disconnect:function(n){return"timeout"!==n&&"error"!==n&&"freeze"!==n&&(this.reconnecting=!1),this.connection.disconnect(n)},destroy:function(){for(var n=0;n<this.unbind.length;n++)this.unbind[n]();this.disconnect("destroy")},reconnect:function(){if(this.attempts>this.options.attempts-1)return this.reconnecting=!1,void(this.attempts=0);var n=this.nextDelay(),e=this;this.timer=setTimeout(function(){!e.reconnecting||e.connecting||e.connected||e.connect()},n)},send:function(){return this.connection.send.apply(this.connection,arguments)},on:function(){return this.connection.on.apply(this.connection,arguments)},nextDelay:function(){var n=this.options.minDelay*Math.pow(2,this.attempts),e=Math.random(),t=Math.floor(.5*e*n);return 1===Math.floor(10*e)&&(t=-t),Math.min(n+t,this.options.maxDelay)||0}},Object.defineProperty(H.prototype,"connected",{get:function(){return this.connection.connected}}),Ha=H;var I={};var Ka=self.crypto||self.msCrypto,La="Uint8ArdomValuesObj012345679BCDEFGHIJKLMNPQRSTWXYZ_cfghkpqvwxyz-";I=function(r){r=r||21;for(var $="",e=Ka.getRandomValues(new Uint8Array(r));0<r--;)$+=La[63&e[r]];return $};var g={};function Ma(o){return(Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(o)}function ea(o){localStorage.setItem(o.options.prefix+":tab:"+o.id,Date.now())}function fa(o,e){o.log.removeReason("tab"+e).then(function(){o.isLocalStorage&&localStorage.removeItem(o.options.prefix+":tab:"+e)})}function Na(o,e){var t={};for(var i in o)e[i]?t[i]=e[i]:t[i]=o[i];return t}var Oa=["id","time","nodes","users","clients","channels"];function ga(o){if(this.options=o||{},void 0===this.options.prefix&&(this.options.prefix="logux"),this.isLocalStorage=!1,"undefined"!=typeof localStorage){var e=I();try{localStorage.setItem(e,"1"),localStorage.removeItem(e),this.isLocalStorage=!0}catch(u){}}var t;this.options.userId=this.options.userId.toString(),this.options.time?(this.id=this.options.time.lastId+1+"",this.clientId=this.options.userId+":"+this.id):(this.clientId=this.options.userId+":"+this.getClientId(),this.id=I(8)),this.nodeId=this.clientId+":"+this.id,/^ws:\/\//.test(this.options.server)&&!o.allowDangerousProtocol&&(t=function(o){return"object"!==Ma(o)||"development"!==o.env?(console.error("Without SSL, old proxies block WebSockets. Use WSS for Logux or set allowDangerousProtocol option."),Promise.resolve(!1)):Promise.resolve(!0)});var i,n=this.options.store||new N;i=this.options.time?this.options.time.nextLog({store:n,nodeId:this.nodeId}):new ba({store:n,nodeId:this.nodeId}),this.log=i;var s=this;i.on("preadd",function(o,e){-1!==e.id.indexOf(" "+s.nodeId+" ")&&!e.subprotocol&&(e.subprotocol=s.options.subprotocol),e.sync&&!e.resubscribe&&e.reasons.push("syncing")}),this.last={},this.subscriptions={};var r={},a={};this.emitter=new k,this.on("add",function(o,e){var t,i,n=o.type;if("logux/processed"!==n&&"logux/undo"!==n||s.log.removeReason("syncing",{id:o.id}),"logux/subscribe"!==n||e.resubscribe){if("logux/unsubscribe"===n)a[e.id]=o;else if("logux/processed"===n&&a[o.id]){var l=a[o.id];t=JSON.stringify(Na(l,{type:"logux/subscribe"}));var c=s.subscriptions[t];c&&(1===c?delete s.subscriptions[t]:s.subscriptions[t]=c-1)}else if("logux/processed"===n&&r[o.id]){var d=r[o.id];delete r[o.id],t=JSON.stringify(d),s.subscriptions[t]?s.subscriptions[t]+=1:s.subscriptions[t]=1,(i=s.last[d.channel])&&!j(i,e)||(s.last[d.channel]={id:e.id,time:e.time})}else"logux/undo"===n?(delete r[o.id],delete a[o.id]):e.channels&&-1===e.id.indexOf(" "+s.clientId+":")&&e.channels.forEach(function(o){(i=s.last[o])&&!j(i,e)||(s.last[o]={id:e.id,time:e.time})});}else r[e.id]=o}),this.tabPing=6e4,this.tabTimeout=10*this.tabPing;var l,c="tab"+s.id;if(this.isLocalStorage)var d=i.on("add",function(o,e){-1!==e.reasons.indexOf(c)&&(ea(s),s.pinging=setInterval(function(){ea(s)},s.tabPing),d())});if("string"==typeof this.options.server){var $=new Ga(this.options.server);l=new Ha($,{minDelay:this.options.minDelay,maxDelay:this.options.maxDelay,attempts:this.options.attempts})}else l=this.options.server;this.node=new _(this.nodeId,this.log,l,{credentials:this.options.credentials,subprotocol:this.options.subprotocol,outFilter:function(o,e){var t=e.id.split(" ")[1].replace(/:.*$/,"");return Promise.resolve(!!e.sync&&t===s.options.userId)},timeout:this.options.timeout,outMap:function(o,e){var t={};for(var i in e)-1!==Oa.indexOf(i)&&(t[i]=e[i]),e.subprotocol&&e.subprotocol!==s.options.subprotocol&&(t.subprotocol=e.subprotocol);return Promise.resolve([o,t])},ping:this.options.ping,auth:t}),this.node.on("debug",function(o,e){"error"===o&&console.error("Error on Logux server:\n",e)});var f=!0;this.node.on("state",function(){var o=s.node.state;if("synchronized"===o||"sending"===o){if(f)for(var e in f=!1,s.subscriptions){var t=JSON.parse(e),i=s.last[t.channel];i&&(t.since=i),s.log.add(t,{sync:!0,resubscribe:!0})}}else"disconnected"===s.node.state&&(f=!0)}),this.onUnload=this.onUnload.bind(this),"undefined"!=typeof window&&window.addEventListener("unload",this.onUnload)}ga.prototype={start:function(){this.cleanPrevActions(),this.node.connection.connect()},on:function(o,e){return this.log.emitter.on(o,e)},destroy:function(){this.onUnload(),this.node.destroy(),clearInterval(this.pinging),"undefined"!=typeof window&&window.removeEventListener("unload",this.onUnload)},clean:function(){return this.destroy(),this.log.store.clean?this.log.store.clean():Promise.resolve()},cleanPrevActions:function(){if(this.isLocalStorage)for(var o in localStorage){var e=this.options.prefix+":tab:";if(o.slice(0,e.length)===e){var t=parseInt(localStorage.getItem(o));Date.now()-t>this.tabTimeout&&fa(this,o.slice(e.length))}}},onUnload:function(){this.pinging&&fa(this,this.id)},getClientId:function(){return I(8)}},g=ga;var Pa={};function c(e,t){return e.options.prefix+":"+e.options.userId+":"+t}function n(e,t,i){e.isLocalStorage&&localStorage.setItem(c(e,t),JSON.stringify(i))}function ha(e){var t=localStorage.getItem(c(e,"leader")),i=[];return"string"==typeof t&&(i=JSON.parse(t)),i}function ia(e){n(e,"leader",[e.id,Date.now()])}function ja(e){"disconnected"!==e.state&&ma(e,"disconnected"),la(e)}function w(e){clearTimeout(e.watching),e.watching=setTimeout(function(){ka(e)?w(e):ja(e)},e.roleTimeout)}function o(e,t){if(e.role!==t){var i=e.node;if(e.role=t,clearTimeout(e.watching),"leader"===t?(localStorage.removeItem(c(e,"state")),e.leadership=setInterval(function(){e.unloading||ia(e)},e.leaderPing),i.connection.connect()):(clearTimeout(e.elections),clearInterval(e.leadership),"disconnected"!==i.state&&e.node.connection.disconnect()),"follower"===t){var a="disconnected",r=localStorage.getItem(c(e,"state"));r&&null!==r&&(a=JSON.parse(r)),a!==e.state&&(e.state=a,e.emitter.emit("state"))}e.emitter.emit("role")}}function ka(e){var t=ha(e);return t[1]&&t[1]>=Date.now()-e.leaderTimeout}function la(e){ia(e),o(e,"candidate"),e.elections=setTimeout(function(){ha(e,"leader")[0]===e.id?o(e,"leader"):(o(e,"follower"),w(e))},e.electionDelay)}function ma(e,t){e.state=t,e.emitter.emit("state"),n(e,"state",e.state)}function na(e){return e.created&&e.added}function p(e){g.call(this,e),this.role="candidate",this.roleTimeout=3e3+Math.floor(1e3*Math.random()),this.leaderTimeout=5e3,this.leaderPing=2e3,this.electionDelay=1e3,this.state=this.node.state;var t=this;this.node.on("state",function(){"leader"===t.role&&ma(t,t.node.state)}),this.log.on("add",function(e,i){t.emitter.emit("add",e,i),i.tab!==t.id&&n(t,"add",[t.id,e,i])}),this.log.on("clean",function(e,i){t.emitter.emit("clean",e,i),i.tab!==t.id&&n(t,"clean",[t.id,e,i])}),this.onStorage=this.onStorage.bind(this),this.onUnload=this.onUnload.bind(this),"undefined"!=typeof window&&(window.addEventListener("storage",this.onStorage),window.addEventListener("unload",this.onUnload))}p.prototype={start:function(){if(this.cleanPrevActions(),!this.isLocalStorage)return this.role="leader",this.emitter.emit("role"),void this.node.connection.connect();ka(this)?(o(this,"follower"),w(this)):la(this)},destroy:function(){g.prototype.destroy.call(this),clearTimeout(this.watching),clearTimeout(this.elections),clearInterval(this.leadership),"undefined"!=typeof window&&window.removeEventListener("storage",this.onStorage)},clean:function(){return this.isLocalStorage&&(localStorage.removeItem(c(this,"add")),localStorage.removeItem(c(this,"clean")),localStorage.removeItem(c(this,"state")),localStorage.removeItem(c(this,"client")),localStorage.removeItem(c(this,"leader"))),g.prototype.clean.call(this)},on:function(e,t){return"preadd"===e?this.log.emitter.on(e,t):this.emitter.on(e,t)},onStorage:function(e){var t;if(null!==e.newValue)if(e.key===c(this,"add"))(t=JSON.parse(e.newValue))[0]!==this.id&&(t[2].tab&&t[2].tab!==this.id||(na(this.log.store)&&this.log.store.add(t[1],t[2]),this.emitter.emit("add",t[1],t[2]),"leader"===this.role&&this.node.onAdd(t[1],t[2])));else if(e.key===c(this,"clean"))(t=JSON.parse(e.newValue))[0]!==this.id&&(t[2].tab&&t[2].tab!==this.id||(na(this.log.store)&&this.log.store.remove(t[2].id),this.emitter.emit("clean",t[1],t[2])));else if(e.key===c(this,"leader"))0===(t=JSON.parse(e.newValue)).length?ja(this):t[0]!==this.id&&"candidate"!==this.role&&(o(this,"follower"),w(this));else if(e.key===c(this,"state")){var i=JSON.parse(localStorage.getItem(e.key));this.state!==i&&(this.state=i,this.emitter.emit("state"))}},onUnload:function(){"leader"===this.role&&(this.unloading=!0,n(this,"leader",[])),g.prototype.onUnload.call(this)},getClientId:function(){var e=c(this,"client");if(this.isLocalStorage){if(localStorage.getItem(e))return localStorage.getItem(e);var t=g.prototype.getClientId.call(this);return localStorage.setItem(e,t),t}return g.prototype.getClientId.call(this)}},p.prototype=s(p.prototype,g.prototype),Object.defineProperty(p.prototype,"connected",{get:function(){return"disconnected"!==this.state&&"connecting"!==this.state}}),Pa=p;var Qa={};Qa="offline.4da2962e.png";var Ra={};Ra={synchronized:"Your data has been saved",disconnected:"No Internet connection",wait:"No Internet connection<br>Your data has not been saved",sending:"Data saving",syncError:"Server error<br>Your data has not been saved",error:"Server error<br>You changes was reverted",denied:"You have no access<br>You changes was reverted",protocolError:"Saving is not working<br>Refresh the page"};var Sa={};Sa="normal.ac3f3bb4.png";var Ta={};Ta="error.fcfdaa52.png";var oa={};oa="refresh.89c0a9e0.svg";var Ua={};Ua="success.d746d596.svg";var pa={};pa="offline.4e5cd61b.svg";var Va={};Va="error.100b16d0.svg";var Wa={};Wa={base:{position:"fixed",width:"15.4em",height:"4em",lineHeight:"1.4",margin:"1.5em",paddingLeft:"4.2em",opacity:"0.8",borderRadius:"0.4em",color:"#fff",fontFamily:"Helvetica Neue, sans-serif",zIndex:"999",backgroundPosition:"1.2em center",backgroundRepeat:"no-repeat",backgroundSize:"1.8em"},text:{display:"table-cell",verticalAlign:"middle",height:"4em"},synchronized:{backgroundColor:"#000",backgroundImage:"url("+Ua+")"},disconnected:{backgroundColor:"#000",backgroundImage:"url("+pa+")"},wait:{backgroundColor:"#000",backgroundImage:"url("+pa+")"},sending:{backgroundColor:"#000",backgroundImage:"url("+oa+")"},error:{backgroundColor:"#F42A2A",backgroundImage:"url("+Va+")"},protocolError:{backgroundColor:"#000",backgroundImage:"url("+oa+")"}};var Xa={};function Ya(t){var n=document,e=!1,i=[],o=!1;function u(){e&&(n.title=e,e=!1)}function d(){n.hidden&&!e?(e=n.title,n.title="* "+n.title):u(),n.hidden&&(o=setTimeout(d,1e3))}function r(){!n.hidden&&o&&(o=clearTimeout(o),u())}return n&&void 0!==n.hidden&&(i.push(t.node.on("error",function(t){"timeout"===t.type||o||d()})),i.push(t.on("add",function(t){"logux/undo"===t.type&&t.reason&&!o&&d()})),document.addEventListener("visibilitychange",r,!1),i.push(function(){document.removeEventListener("visibilitychange",r,!1)})),function(){for(var t=0;t<i.length;t++)i[t]()}}Xa=Ya;var Za={};function qa(n){return void 0===n&&(n=window.event),n&&(n.returnValue="unsynced"),"unsynced"}function $a(n){var e="disconnected"===n.state,o=!1;function r(){"disconnected"===n.state?e=!0:"synchronized"===n.state&&(e=!1,o=!1),"follower"!==n.role&&o&&e?window.addEventListener("beforeunload",qa):window.removeEventListener("beforeunload",qa)}var t=[];return t.push(n.on("role",r)),t.push(n.on("state",r)),r(),t.push(n.on("add",function(n,t){"logux/subscribe"!==n.type&&"logux/unsubscribe"!==n.type&&e&&t.sync&&t.added&&(o=!0,r())})),function(){for(var n=0;n<t.length;n++)t[n]()}}Za=$a;var _a={};function ab(n,e){var o=e.normal,r=e.offline,t=e.error,a=[],c=document,f=!1,i=!1;function u(){n.connected&&i!==o?f.href=i=o:!n.connected&&r&&i!==r&&i!==t&&(f.href=i=r)}function d(){t&&i!==t&&(f.href=i=t)}return c&&(f=c.querySelector("link[rel~=\"icon\"]"),void 0===o&&(o=f?f.href:""),f||((f=c.createElement("link")).rel="icon",f.href="",c.head.appendChild(f)),a.push(n.on("state",u)),u(),a.push(n.on("add",function(n){"logux/undo"===n.type&&n.reason&&d()})),a.push(n.node.on("error",function(n){"timeout"!==n.type&&d()}))),function(){for(var n=0;n<a.length;n++)a[n]()}}_a=ab;var ra={};function bb(t,e,o){var n,r=t.on?t:t.node,i="disconnected"===r.state,s=!1,c=!1;o||(o={}),void 0===o.duration&&(o.duration=3e3);var d=[],u={};function a(){0===Object.keys(u).length&&(s?(s=!1,e("synchronizedAfterWait"),n=setTimeout(function(){e("synchronized")},o.duration)):e("synchronized"))}d.push(r.on("state",function(){clearTimeout(n),c||("disconnected"===r.state?(i=!0,e(s?"wait":"disconnected")):"synchronized"===r.state?(i=!1,a()):"connecting"===r.state?n=setTimeout(function(){e("connecting"+(s?"AfterWait":""))},100):e(t.state+(s?"AfterWait":"")))})),d.push(t.node.on("error",function(t){"wrong-protocol"===t.type||"wrong-subprotocol"===t.type?(c=!0,e("protocolError")):"timeout"!==t.type&&e("syncError",{error:t})})),d.push(t.node.on("clientError",function(t){e("syncError",{error:t})}));var p=t.on?t:t.log;return d.push(p.on("add",function(t,o){"logux/subscribe"!==t.type&&"logux/unsubscribe"!==t.type&&("logux/processed"===t.type?(delete u[t.id],a()):"logux/undo"===t.type?delete u[t.id]:o.sync&&(u[o.id]=!0),"logux/undo"===t.type&&t.reason?"denied"===t.reason?e("denied",{action:t,meta:o}):e("error",{action:t,meta:o}):i&&o.sync&&o.added&&(s||e("wait"),s=!0))})),function(){for(var t=0;t<d.length;t++)d[t]()}}ra=bb;var cb={};function x(t,e){for(var r in e)t.style[r]=e[r]}function db(t,e){var r=t.style;"middle-center"===e||"center-middle"===e?(r.top="50%",r.left="50%",r.transform="translate(-50%, -50%)"):e.split("-").forEach(function(t){"middle"===t?(r.top="50%",r.transform="translateY(-50%)"):"center"===t?(r.left="50%",r.transform="translateX(-50%)"):r[t]="0"})}var eb={boxSizing:"content-box",visibility:"visible",textIndent:"0",textTransform:"none",wordSpacing:"normal",letterSpacing:"normal",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineHeight:"auto"};function fb(t,e){var r=e.messages,n=e.position||"bottom-right",o=e.styles,i=document.createElement("div"),a=document.createElement("span");function s(t,e){a.innerHTML=e,x(i,t),i.style.display="block"}i.setAttribute("role","alert"),x(i,eb),x(i,o.base),x(a,o.text),db(i,n);var $=ra(t,function(t){"sendingAfterWait"===t||"connectingAfterWait"===t?s(o.sending,r.sending):"synchronizedAfterWait"===t?s(o.synchronized,r.synchronized):"synchronized"===t?i.style.display="none":"disconnected"===t?s(o.disconnected,r.disconnected):"wait"===t?s(o.wait,r.wait):"protocolError"===t?s(o.protocolError,r.protocolError):"syncError"===t?s(o.error,r.syncError):"error"===t?s(o.error,r.error):"denied"===t&&s(o.error,r.denied)},e);return i.appendChild(a),document.body.appendChild(i),function(){$(),document.body.removeChild(i)}}cb=fb;var gb={};function hb(){if("undefined"==typeof window||"undefined"==typeof document)return!1;var e=navigator.userAgent.toLowerCase().indexOf("edge")>-1,o="WebkitAppearance"in document.documentElement.style,n=window.console&&(window.console.firebug||window.console.exception&&window.console.table)&&!0,t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31;return o&&!e||n||t||!1}gb=hb;var ib={};function d(e){return"%c"+e+"%c"}function sa(e,o,r,t){o="%cLogux%c "+o,e||(o=o.replace(/%c/g,""));var n=[o];if(e)for(var s=o.match(/%c[^%]+%c/g),c=0;c<s.length;c++)0===c?n.push("color:#ffa200;font-weight:bold"):n.push("font-weight:bold"),n.push("");return r&&n.push(r),t&&n.push(t),n}function jb(e,o){o||(o={});var r=e.node,t=!1!==o.color&&gb();function n(e,o,r){console.log.apply(console,sa(t,e,o,r))}function s(e){var o="error: "+e.description;e.received&&(o="server sent "+o),console.error.apply(console,sa(t,o))}var c=[],a=!1;!1!==o.state&&c.push(e.on("state",function(){var o="";"connecting"===e.state&&r.connection.url?o=". "+d(r.localNodeId)+" is connecting to "+d(r.connection.url)+".":e.connected&&!a&&r.remoteNodeId?(o=". Client was connected to "+d(r.remoteNodeId)+".",a=!0):e.connected||(a=!1),n("state is "+d(e.state)+o)})),!1!==o.role&&c.push(e.on("role",function(){n("tab role is "+d(e.role))})),!1!==o.error&&(c.push(r.on("error",function(e){s(e)})),c.push(r.on("clientError",function(e){s(e)})));var l={},$=(o.ignoreActions||[]).reduce(function(e,o){return e[o]=!0,e},{});return!1!==o.add&&c.push(e.on("add",function(o,t){var s;if((!t.tab||t.tab===e.id)&&!$[o.type])if("logux/subscribe"===o.type)s="subscribed to channel "+d(o.channel),2===Object.keys(o).length?n(s):n(s,o);else if("logux/processed"===o.type)n("action "+d(o.id)+" was processed");else if("logux/undo"===o.type)s="action "+d(o.id)+" was undid because of "+d(o.reason),3===Object.keys(o).length?n(s):n(s,o);else{s="added ",0===t.reasons.length&&(l[t.id]=!0,s+="and cleaned "),s+=d(o.type)+" action";var c=t.id.split(" ")[1];c!==r.localNodeId&&(s+=" from "+d(c)),n(s,o,t)}})),!1!==o.clean&&c.push(e.on("clean",function(o,r){l[r.id]?delete l[r.id]:r.tab&&r.tab!==e.id||$[o.type]||"logux/subscribe"!==o.type&&"logux/processed"!==o.type&&"logux/undo"!==o.type&&n("cleaned "+d(o.type)+" action",o,r)})),function(){for(var e=0;e<c.length;e++)c[e]()}}ib=jb;var J=new Ea(500),K=new ba({store:new N,nodeId:"server:uuid"});new C("server:uuid",K,J.right),K.on("add",function(o,$){"logux/processed"!==o.type&&setTimeout(function(){K.add({type:"logux/processed",id:$.id})},500)});var a=new Pa({subprotocol:"1.0.0",userId:10,server:"wss://example.com/"}),L=new _(a.node.localNodeId,a.log,J.left);L.connection.url="wss://example.com/",L.emitter=a.node.emitter,a.node=L,Xa(a),Za(a),_a(a,{normal:Sa,offline:Qa,error:Ta}),cb(a,{messages:Ra,styles:Wa}),ib(a),ra(a,function(o){document.all.status.innerText=o});var y=0;function kb(o){return"disconnected"===o?"\uD83D\uDE34":"connecting"===o?"\uD83D\uDD0C":"\uD83D\uDE0A"}function lb(o){return o.slice(0,1).toUpperCase()}function q(){document.title=kb(a.state)+" "+lb(a.role)+" "+y}a.on("state",function(){document.all.connection.checked=a.connected,q()}),a.on("role",function(){q(),document.all.connection.disabled="leader"!==a.role}),a.on("add",function(o){"TICK"===o.type&&y++,q()}),a.on("clean",function(o){"TICK"===o.type&&y--,q()}),a.log.each(function(o){"TICK"===o.type&&y++}).then(function(){q()}),a.on("role",function(){var o="leader"===a.role;document.all.connection.disabled=!o,document.all.disabled.style.display=o?"none":"inline"}),a.start(),document.all.connection.onchange=function(o){o.target.checked?a.node.connection.connect():a.node.connection.disconnect()},document.all.add.onclick=function(){a.log.add({type:"TICK"},{reasons:["tick"],sync:!0})},document.all.clean.onclick=function(){a.log.removeReason("tick")},document.all.error.onclick=function(){setTimeout(function(){a.log.add({type:"logux/undo",reason:"error"})},3e3)},document.all.denied.onclick=function(){setTimeout(function(){a.log.add({type:"logux/undo",reason:"denied"})},3e3)},document.all.serverError.onclick=function(){setTimeout(function(){J.right.send(["error","wrong-format"])},3e3)},document.all.subprotocolError.onclick=function(){a.node.syncError("wrong-subprotocol",{supported:"2.x",used:"1.0.0"})};})();